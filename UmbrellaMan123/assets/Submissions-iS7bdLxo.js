import{p as j,e as l,f as L,r as c,o as f,c as X,w as n,a as r,b as u,d as M,l as F,m as G,q,h as y,t as w,j as V,F as E}from"./index-Cp7s-4N5.js";import{s as S}from"./services-aMzByWOt.js";const R={class:"d-flex ga-4 mb-2 mr-2"},T={__name:"DeleteSubmissionModal",props:{showModal:Boolean},emits:["update:showModal","confirm"],setup(B,{emit:C}){j();const x=B,m=C,a=l(!1);L(()=>x.showModal,o=>{a.value=o}),L(a,o=>{m("update:showModal",o)});const v=()=>{m("confirm"),a.value=!1};return(o,e)=>{const i=c("v-btn"),_=c("XBaseModal");return f(),X(_,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=b=>a.value=b)},{title:n(()=>e[2]||(e[2]=[r("div",{class:"ml-4 mt-2"},"刪除作品",-1)])),text:n(()=>e[3]||(e[3]=[r("div",{class:"ml-2"},"刪除後將無法復原，確定要刪除嗎？",-1)])),actions:n(()=>[r("div",R,[u(i,{class:"btn-red",onClick:v},{default:n(()=>e[4]||(e[4]=[M("確認")])),_:1}),u(i,{variant:"outlined",class:"",onClick:e[0]||(e[0]=b=>a.value=!1)},{default:n(()=>e[5]||(e[5]=[M("取消")])),_:1})])]),_:1},8,["modelValue"])}}},z={class:"text-center d-flex justify-center align-center ga-2 my-4"},A={key:0,class:"page-info mb-4"},H={key:1},P={__name:"Submissions",setup(B){const C=F(),x=G(()=>C.state.isLoading),m=l(!1);l(!1);const a=l(""),v=l({name:"",phone:"",email:""}),o=l([]),e=l(""),i=l(""),_=async()=>{i.value="",o.value=[];const t={phone:a.value},[s,p]=await S.getSubmissions(t);p?(b(p),console.log(p)):i.value=s},b=t=>{o.value=t.items,console.log("submissionsList:",o.value),v.value={name:t.name,phone:t.phone,email:t.email},e.value=t.detaching_id,o.value.length===0&&(i.value="查無資料")},I=async t=>{m.value=!0;const s={detaching_id:e.value,image_uuid:h.value},[p,g]=await S.deleteImage(s);g&&(console.log(g),_()),m.value=!1},h=l(""),k=q({delete:!1}),D={delete:t=>{k.delete=!0,h.value=t}};return(t,s)=>{const p=c("v-text-field"),g=c("v-btn"),N=c("XLoadingCircle"),$=c("XCardImage"),U=c("XBaseGridLayout");return f(),y(E,null,[s[4]||(s[4]=r("h1",{class:"page-title"},"個人提交作品",-1)),r("div",z,[u(p,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=d=>a.value=d),label:"請輸入手機號碼",density:"compact",variant:"outlined","hide-details":"","max-width":"600"},null,8,["modelValue"]),u(g,{class:"btn-orange",onClick:_},{default:n(()=>s[2]||(s[2]=[M("查詢")])),_:1})]),o.value.length>0?(f(),y("div",A,[r("p",null,"姓名："+w(v.value.name),1),r("p",null,"手機號碼："+w(v.value.phone),1),r("p",null,"電子郵件："+w(v.value.email),1)])):V("",!0),i.value?(f(),y("p",H,w(i.value),1)):V("",!0),x.value&&!m.value?(f(),X(N,{key:2})):V("",!0),u(U,{cards:o.value},{card:n(({item:d})=>[u($,{imgSrc:d.images[0].image_path,description:d.description},{actions:n(()=>[u(g,{onClick:J=>D.delete(d.uuid),loading:m.value&&d.uuid===h.value,class:"btn-red"},{default:n(()=>s[3]||(s[3]=[M(" 刪除 ")])),_:2},1032,["onClick","loading"])]),_:2},1032,["imgSrc","description"])]),_:1},8,["cards"]),u(T,{showModal:k.delete,"onUpdate:showModal":s[1]||(s[1]=d=>k.delete=d),onConfirm:I},null,8,["showModal"])],64)}}};export{P as default};
